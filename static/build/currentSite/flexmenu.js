!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}((function(e){var i,n=[];e(window).resize((function(){clearTimeout(i),i=setTimeout((function(){e(n).each((function(){e(this).flexMenu({undo:!0}).flexMenu(this.options)}))}),200)})),e.fn.flexMenu=function(i){var l,t=e.extend({threshold:2,cutoff:2,linkText:"More",linkTitle:"View More",linkTextAll:"Menu",linkTitleAll:"Open/Close Menu",showOnHover:!0,popupAbsolute:!0,undo:!1},i);return this.options=t,(l=e.inArray(this,n))>=0?n.splice(l,1):n.push(this),this.each((function(){var i,n,l,o,f,u,s=e(this),r=s.find("> li"),a=r.first(),p=r.last(),d=s.find("li").length,c=Math.floor(a.offset().top),h=Math.floor(a.outerHeight(!0)),v=!1;function M(e){return Math.ceil(e.offset().top)>=c+h}if(M(p)&&d>t.threshold&&!t.undo&&s.is(":visible")){var x=e('<ul class="flexMenu-popup" style="display:none;'+(t.popupAbsolute?" position: absolute;":"")+'"></ul>');for(a.offset().top,u=d;u>1;u--){if(n=M(i=s.find("> li:last-child")),i.appendTo(x),u-1<=t.cutoff){e(s.children().get().reverse()).appendTo(x),v=!0;break}if(!n)break}v?s.append('<li class="flexMenu-viewMore flexMenu-allInPopup"><a href="#" title="'+t.linkTitleAll+'">'+t.linkTextAll+"</a></li>"):s.append('<li class="flexMenu-viewMore"><a href="#" title="'+t.linkTitle+'" class="more-link">'+t.linkText+"</a></li>"),M(l=s.find("> li.flexMenu-viewMore"))&&s.find("> li:nth-last-child(2)").appendTo(x),x.children().each((function(e,i){x.prepend(i)})),l.append(x),s.find("> li.flexMenu-viewMore > a").click((function(i){var n;n=l,e("li.flexMenu-viewMore.active").not(n).removeClass("active").find("> ul").hide(),x.toggle(),l.toggleClass("active"),i.preventDefault()})),t.showOnHover&&l.hover((function(){x.show(),e(this).addClass("active")}),(function(){x.hide(),e(this).removeClass("active")}))}else if(t.undo&&s.find("ul.flexMenu-popup")){for(o=(f=s.find("ul.flexMenu-popup")).find("li").length,u=1;u<=o;u++)f.find("> li:first-child").appendTo(s);f.remove(),s.find("> li.flexMenu-viewMore").remove()}}))}}));